package org.opentestsystem.ap.itemcompare.service;

import lombok.extern.slf4j.Slf4j;
import org.apache.commons.io.FilenameUtils;
import org.opentestsystem.ap.itemcompare.ApplicationProperties;
import org.opentestsystem.ap.itemcompare.util.GitLabApiClient;
import org.springframework.stereotype.Component;

import java.nio.file.Path;

@Slf4j
@Component
public class CompareService {

    private final GitLabApiClient gitLabApiClient;

    private final ApplicationProperties applicationProperties;

    public CompareService(GitLabApiClient gitLabApiClient,
                          ApplicationProperties applicationProperties) {
        this.gitLabApiClient = gitLabApiClient;
        this.applicationProperties = applicationProperties;
    }

    public void compare() {
        try {
            final Path archiveFile = this.gitLabApiClient.downloadItem(applicationProperties.getItemId());
            final String legacyId = FilenameUtils.removeExtension(archiveFile.toFile().getName());
//            copyContext.setArchiveFile(archiveFile).setLegacyId(legacyId);
        } catch (Exception e) {
            log.error(e.getMessage(), e);
//            copyContext.setFailedMessage(e.getMessage());
        }
    }





}
