package org.opentestsystem.ap.itemcompare.report;

import lombok.extern.slf4j.Slf4j;
import org.opentestsystem.ap.itemcompare.util.CompareUtil;

import java.nio.file.Path;

/**
 * Stores compare results to a file
 */
@Slf4j
public class CompareReportFile {

    private Path reportFile;

    public CompareReportFile(CompareReport compareReport, String itemId) {
       reportFile = compareReport.getCompareReportPath().resolve(itemId + ".csv");
       try {
           CompareUtil.writeToFile(reportFile.toFile(),
                   "\"ItemId\",\"ItemType\",\"FileName\",\"DifferenceType\",\"ImportElementName\",\"ImportAttributes\",\"ImportValue\",\"TimsValue\",\"ImportXPath\"\n");
       } catch (Exception ex) {
           log.error("Unable to write item report file", ex);
       }
    }

    public void write(String value) {
        try {
            value = value + "\n";
            CompareUtil.writeToFile(reportFile.toFile(), value);
        } catch (Exception ex) {
            log.error("Unable to write item report file", ex);
        }
    }
}
