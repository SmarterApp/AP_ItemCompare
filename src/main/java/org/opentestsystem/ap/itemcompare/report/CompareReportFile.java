package org.opentestsystem.ap.itemcompare.report;

import lombok.extern.slf4j.Slf4j;

import java.nio.file.Files;
import java.nio.file.Path;
import java.nio.file.StandardOpenOption;

/**
 * Stores compare results to a file
 */
@Slf4j
public class CompareReportFile {

    private Path reportFile;

    public CompareReportFile(CompareReport compareReport, String itemId) {
       reportFile = compareReport.getCompareReportPath().resolve(itemId + ".csv");
       try {
           Files.write(reportFile, "\"ItemId\",\"ItemType\",\"FileName\",\"DifferenceType\",\"ImportElementName\",\"ImportAttributes\",\"ImportValue\",\"TimsValue\",\"XPath\"\n".getBytes());
       } catch (Exception ex) {
           log.error("Unable to write item report file", ex);
       }
    }

    public void write(String value) {
        try {
            value = value + "\n";
            Files.write(reportFile, value.getBytes(), StandardOpenOption.APPEND);
        } catch (Exception ex) {
            log.error("Unable to write item report file", ex);
        }
    }
}
